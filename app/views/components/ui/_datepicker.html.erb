<div data-controller="datepicker visibility" <%= tag.attributes(class: container_classes) %> data-action="keydown.esc->datepicker#close">
  <%= hidden_field_tag name, value, data: { "datepicker-target": "viewValue" } %>
  <%= text_field_tag nil, "#{value.blank? ? "" : I18n.l(value)}",
    type: type,
    id: id,
    class: input_classes,
    placeholder: options[:placeholder],
    disabled: options[:disabled],
    required: options[:required],
    readonly: options[:readonly],
    data: { "datepicker-target": "viewInput", "action": "input->datepicker#change focus->visibility#toggleTargets" }
  %>
  <% if options[:has_error] %>
    <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3">
      <%= inline_svg_tag "heroicons-calendar.svg", class: "h-5 w-5 text-red-500" %>
    </div>
  <% else %>
    <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3">
      <%= inline_svg_tag "heroicons-calendar.svg", class: "h-5 w-5" %>
    </div> 
  <% end %>
  <div class="absolute top-12 w-3/4 inset-y-0 left-0 hidden"
       data-visibility-target="hideable"
       data-datepicker-target="datepicker">
    <!-- Render the datepicker -->
    <%= compact_month_calendar(month_date: value, datepicker: true, route: "calendar_datepicker_path") %>
  </div>
</div>
<!-- Hint -->
<% if options[:hint].present? && !options[:has_error] %>
  <p class="mt-2 text-sm text-gray-500"><%= options[:hint] %></p>
<% end %>
<!-- Error -->
<% if options[:has_error] %>
  <p class="mt-2 text-sm text-red-600">
    <% options[:errors].each do |error| %>
      <%= error %>
    <% end %>
  </p>
<% end %>
